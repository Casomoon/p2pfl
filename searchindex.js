Search.setIndex({"docnames": ["documentation", "index", "installation", "p2pfl", "p2pfl.learning", "p2pfl.learning.agregators", "p2pfl.learning.pytorch", "p2pfl.learning.pytorch.mnist_examples", "p2pfl.learning.pytorch.mnist_examples.models", "p2pfl.utils"], "filenames": ["documentation.rst", "index.md", "installation.md", "p2pfl.rst", "p2pfl.learning.rst", "p2pfl.learning.agregators.rst", "p2pfl.learning.pytorch.rst", "p2pfl.learning.pytorch.mnist_examples.rst", "p2pfl.learning.pytorch.mnist_examples.models.rst", "p2pfl.utils.rst"], "titles": ["Documentation", "P2P Federated Learning", "Installation", "p2pfl package", "p2pfl.learning package", "p2pfl.learning.agregators package", "p2pfl.learning.pytorch package", "p2pfl.learning.pytorch.mnist_examples package", "p2pfl.learning.pytorch.mnist_examples.models package", "p2pfl.utils package"], "terms": {"p2pfl": [0, 1], "packag": [0, 1], "subpackag": [0, 1], "learn": [0, 3], "submodul": [0, 1], "except": [0, 3], "modul": [0, 1], "learner": [0, 3, 6], "content": [0, 1], "util": [0, 1, 3], "observ": [0, 3, 5], "base_nod": [0, 1], "command": [0, 1], "communication_protocol": [0, 1], "const": [0, 1], "heartbeat": [0, 1], "node": [0, 1], "node_connect": [0, 1], "agreg": [3, 4], "fedavg": [3, 4], "pytorch": [0, 1], "lightninglearn": [0, 1], "mnist_exampl": [0, 1, 6], "mnistfederated_dm": [0, 6], "logger": [0, 1], "model": [3, 4, 5, 6, 7], "cnn": [6, 7], "mlp": [6, 7], "librari": 1, "us": [1, 3, 4, 6, 7], "architectur": 1, "bla": 1, "sphinx": 1, "apidoc": 1, "f": 1, "o": 1, "tmp": 1, "instal": 1, "document": 1, "xd": 2, "class": [3, 4, 5, 6, 7, 8, 9], "basenod": 3, "host": 3, "127": 3, "0": [3, 6, 7, 8], "1": [3, 7, 8], "port": 3, "sourc": [3, 4, 5, 6, 7, 8, 9], "base": [3, 4, 5, 6, 7, 8, 9], "thread": [3, 5], "thi": [3, 5], "repres": [3, 5, 9], "network": [3, 8], "without": 3, "fl": 3, "It": [3, 4, 6], "so": 3, "s": [3, 5], "go": 3, "process": [3, 4, 6], "all": 3, "messag": 3, "background": 3, "communicationprotocol": 3, "paramet": [3, 4, 6, 7], "str": 3, "The": [3, 4, 5, 6, 7], "int": 3, "type": 3, "node_socket": 3, "socket": 3, "neightboor": 3, "list": 3, "add_neighbor": 3, "n": [3, 5], "add": 3, "nodeconnect": 3, "ad": 3, "broadcast": 3, "msg": 3, "ttl": 3, "exc": 3, "is_necesari": 3, "true": 3, "time": 3, "live": 3, "exclud": 3, "bool": [3, 8], "If": 3, "fals": [3, 5], "sent": 3, "onli": 3, "its": 3, "posibl": 3, "connect_to": 3, "h": 3, "p": 3, "full": 3, "connect": 3, "entir": 3, "disconnect_from": 3, "disconnect": 3, "from": [3, 5], "get_addr": 3, "return": [3, 4, 6], "address": 3, "tupl": 3, "get_neighbor": 3, "get": [3, 4, 6], "rm_neighbor": 3, "remov": 3, "run": [3, 5], "main": 3, "loop": 3, "listen": 3, "new": 3, "them": 3, "start": 3, "stop": 3, "implement": [3, 4, 9], "pattern": [3, 9], "beat_cmd": 3, "parent_nod": 3, "should": 3, "execut": 3, "respons": 3, "beat": 3, "object": [3, 4, 5, 9], "arg": [3, 5], "conn_to_cmd": 3, "conn_to": 3, "num_samples_cmd": 3, "num_sampl": 3, "num": 3, "params_cmd": 3, "param": [3, 4, 6], "done": 3, "ready_cmd": 3, "readi": 3, "round": [3, 6], "start_learning_cmd": 3, "start_learn": 3, "epoch": [3, 4, 6], "stop_cmd": 3, "stop_learning_cmd": 3, "stop_learn": 3, "command_dict": 3, "manag": 3, "mean": 3, "commun": 3, "valid": [3, 7], "ar": [3, 4, 6], "ip": 3, "data": [3, 4, 6, 7], "send_model": 3, "uniqu": 3, "non": [3, 4, 6], "static": 3, "method": [3, 5], "stablish": 3, "dictionari": 3, "callback": 3, "process_messag": 3, "conn": 3, "build_beat_msg": 3, "A": 3, "encod": [3, 4, 6], "build_connect_msg": 3, "tri": 3, "whether": 3, "build_connect_to_msg": 3, "build_num_samples_msg": 3, "number": [3, 4, 6, 7], "sampl": [3, 4, 6], "train": [3, 6, 8], "build_params_msg": 3, "send": 3, "fragment": 3, "build_ready_msg": 3, "last": 3, "finish": 3, "build_start_learning_msg": 3, "build_stop_learning_msg": 3, "build_stop_msg": 3, "check_collaps": 3, "check": [3, 4, 6], "collaps": 3, "binari": [3, 4, 6], "fill": 3, "buffer": 3, "befor": 3, "length": 3, "byte": 3, "headear": 3, "process_connect": 3, "do": 3, "what": 3, "legit": 3, "associ": 3, "wa": 3, "error": 3, "occur": 3, "otherwis": 3, "defin": 3, "constant": 3, "system": 3, "nodo_padr": 3, "neighbor": 3, "everi": 3, "heartbeat_frec": 3, "second": 3, "add_model": [3, 5], "m": [3, 5], "w": [3, 5], "isn": 3, "t": 3, "inicializ": 3, "reciev": 3, "ha": 3, "weight": 3, "set_data": [3, 4, 6], "set": [3, 4, 6, 7], "dataset": 3, "set_model": [3, 4, 6], "carefulli": 3, "set_start_learn": 3, "set_stop_learn": 3, "local": [3, 6], "interrupt": [3, 4, 6], "updat": [3, 9], "event": [3, 9], "obj": [3, 9], "handl": 3, "can": [3, 9], "been": 3, "revisarlo": 3, "addr": 3, "reciv": 3, "mani": 3, "singl": 3, "recv": 3, "exist": 3, "2": 3, "kind": 3, "text": 3, "broken": 3, "close": 3, "user": 3, "want": 3, "reconnect": 3, "he": 3, "she": 3, "creat": 3, "parent": 3, "add_param_seg": 3, "segment": 3, "clear_buff": 3, "clear": [3, 5], "get_param": 3, "get_ready_statu": 3, "other": 3, "is_sending_model": 3, "being": 3, "guarante": 3, "set_num_sampl": 3, "indic": 3, "otrh": 3, "set_ready_statu": 3, "set_sending_model": 3, "flag": 3, "when": 3, "high": 3, "bandwidth": 3, "notifi": [3, 9], "decodingparamserror": 4, "modelnotmatchingerror": 4, "nodelearn": [4, 6], "check_paramet": [4, 6], "decode_paramet": [4, 6], "encode_paramet": [4, 6], "evalu": [4, 6], "fit": [4, 6], "get_num_sampl": [4, 6], "get_paramet": [4, 6], "interrupt_fit": [4, 6], "predict": [], "set_epoch": [4, 6], "set_paramet": [4, 6], "check_and_run_agreg": 5, "forc": 5, "activ": 5, "you": 5, "mai": 5, "overrid": 5, "subclass": 5, "standard": 5, "invok": 5, "callabl": 5, "pass": 5, "constructor": 5, "target": 5, "argument": 5, "ani": 5, "sequenti": 5, "keyword": 5, "taken": 5, "kwarg": [5, 6], "respect": 5, "log_nam": 6, "none": [6, 9], "mnistfederateddm": 7, "sub_id": 7, "number_sub": 7, "batch_siz": 7, "32": 7, "num_work": 7, "4": 7, "val_perc": 7, "lightningdatamodul": 7, "hola": [], "test_dataload": 7, "train_dataload": 7, "val_dataload": 7, "in_channel": 8, "out_channel": 8, "10": 8, "lightningmodul": 8, "configure_optim": 8, "forward": 8, "x": 8, "test_step": 8, "batch": [7, 8], "batch_idx": 8, "training_step": 8, "batch_id": 8, "validation_step": 8, "lr_rate": 8, "001": 8, "federatedtensorboardlogg": 6, "dir": 6, "name": 6, "version": 6, "lightningloggerbas": 6, "final": 6, "statu": 6, "necessari": [], "an": [], "experi": [], "e": [], "g": [], "success": [], "fail": [], "abort": [], "log_hyperparam": 6, "record": [], "hyperparamet": [], "namespac": [], "contain": [], "option": [], "posit": [], "depend": [], "specif": [], "log_metr": 6, "metric": 6, "step": 6, "log": [], "soon": [], "receiv": [], "aggreg": [], "one": [], "agg_and_log_metr": [], "kei": [], "measur": [], "quantiti": [], "valu": [], "which": [], "properti": 6, "save": 6, "agregation_finish": 9, "end_connect": 9, "node_ready_ev": 9, "add_observ": 9, "get_observ": 9, "compat": [4, 6], "decod": [4, 6], "wheight": [4, 6], "With": [4, 6], "given": [4, 6], "partit": 7, "mnist": [7, 8], "Its": 7, "gener": 7, "iid": 7, "distribucion": 7, "over": 7, "mni": 7, "toi": 7, "problem": 7, "subset": 7, "id": 7, "size": 7, "worker": 7, "percentag": 7, "convolut": 8, "neural": 8, "solv": 8, "lightn": [6, 8], "multilay": 8, "perceptron": 8, "feder": 6, "inform": 6, "persist": 6, "directori": 6, "difer": 6, "templat": 4}, "objects": {"": [[3, 0, 0, "-", "p2pfl"]], "p2pfl": [[3, 0, 0, "-", "base_node"], [3, 0, 0, "-", "command"], [3, 0, 0, "-", "communication_protocol"], [3, 0, 0, "-", "const"], [3, 0, 0, "-", "heartbeater"], [4, 0, 0, "-", "learning"], [3, 0, 0, "-", "node"], [3, 0, 0, "-", "node_connection"], [9, 0, 0, "-", "utils"]], "p2pfl.base_node": [[3, 1, 1, "", "BaseNode"]], "p2pfl.base_node.BaseNode": [[3, 2, 1, "", "add_neighbor"], [3, 2, 1, "", "broadcast"], [3, 2, 1, "", "connect_to"], [3, 2, 1, "", "disconnect_from"], [3, 2, 1, "", "get_addr"], [3, 2, 1, "", "get_neighbor"], [3, 2, 1, "", "get_neighbors"], [3, 3, 1, "", "host"], [3, 3, 1, "", "neightboors"], [3, 3, 1, "", "node_socket"], [3, 3, 1, "", "port"], [3, 2, 1, "", "rm_neighbor"], [3, 2, 1, "", "run"], [3, 2, 1, "", "start"], [3, 2, 1, "", "stop"]], "p2pfl.command": [[3, 1, 1, "", "Beat_cmd"], [3, 1, 1, "", "Command"], [3, 1, 1, "", "Conn_to_cmd"], [3, 1, 1, "", "Num_samples_cmd"], [3, 1, 1, "", "Params_cmd"], [3, 1, 1, "", "Ready_cmd"], [3, 1, 1, "", "Start_learning_cmd"], [3, 1, 1, "", "Stop_cmd"], [3, 1, 1, "", "Stop_learning_cmd"]], "p2pfl.command.Beat_cmd": [[3, 2, 1, "", "execute"]], "p2pfl.command.Command": [[3, 2, 1, "", "execute"]], "p2pfl.command.Conn_to_cmd": [[3, 2, 1, "", "execute"]], "p2pfl.command.Num_samples_cmd": [[3, 2, 1, "", "execute"]], "p2pfl.command.Params_cmd": [[3, 2, 1, "", "execute"]], "p2pfl.command.Ready_cmd": [[3, 2, 1, "", "execute"]], "p2pfl.command.Start_learning_cmd": [[3, 2, 1, "", "execute"]], "p2pfl.command.Stop_cmd": [[3, 2, 1, "", "execute"]], "p2pfl.command.Stop_learning_cmd": [[3, 2, 1, "", "execute"]], "p2pfl.communication_protocol": [[3, 1, 1, "", "CommunicationProtocol"]], "p2pfl.communication_protocol.CommunicationProtocol": [[3, 3, 1, "", "BEAT"], [3, 3, 1, "", "CONN"], [3, 3, 1, "", "CONN_TO"], [3, 3, 1, "", "NUM_SAMPLES"], [3, 3, 1, "", "PARAMS"], [3, 3, 1, "", "READY"], [3, 3, 1, "", "SEND_MODEL"], [3, 3, 1, "", "START_LEARNING"], [3, 3, 1, "", "STOP"], [3, 3, 1, "", "STOP_LEARNING"], [3, 2, 1, "", "build_beat_msg"], [3, 2, 1, "", "build_connect_msg"], [3, 2, 1, "", "build_connect_to_msg"], [3, 2, 1, "", "build_num_samples_msg"], [3, 2, 1, "", "build_params_msg"], [3, 2, 1, "", "build_ready_msg"], [3, 2, 1, "", "build_start_learning_msg"], [3, 2, 1, "", "build_stop_learning_msg"], [3, 2, 1, "", "build_stop_msg"], [3, 2, 1, "", "check_collapse"], [3, 3, 1, "", "command_dict"], [3, 2, 1, "", "process_connection"], [3, 2, 1, "", "process_message"]], "p2pfl.heartbeater": [[3, 1, 1, "", "Heartbeater"]], "p2pfl.heartbeater.Heartbeater": [[3, 2, 1, "", "run"], [3, 2, 1, "", "stop"]], "p2pfl.learning": [[5, 0, 0, "-", "agregators"], [4, 0, 0, "-", "exceptions"], [4, 0, 0, "-", "learner"], [6, 0, 0, "-", "pytorch"]], "p2pfl.learning.agregators": [[5, 0, 0, "-", "agregator"], [5, 0, 0, "-", "fedavg"]], "p2pfl.learning.agregators.agregator": [[5, 1, 1, "", "Agregator"]], "p2pfl.learning.agregators.agregator.Agregator": [[5, 2, 1, "", "add_model"], [5, 2, 1, "", "agregate"], [5, 2, 1, "", "check_and_run_agregation"], [5, 2, 1, "", "clear"], [5, 2, 1, "", "run"]], "p2pfl.learning.agregators.fedavg": [[5, 1, 1, "", "FedAvg"]], "p2pfl.learning.agregators.fedavg.FedAvg": [[5, 2, 1, "", "agregate"]], "p2pfl.learning.exceptions": [[4, 4, 1, "", "DecodingParamsError"], [4, 4, 1, "", "ModelNotMatchingError"]], "p2pfl.learning.learner": [[4, 1, 1, "", "NodeLearner"]], "p2pfl.learning.learner.NodeLearner": [[4, 2, 1, "", "check_parameters"], [4, 2, 1, "", "decode_parameters"], [4, 2, 1, "", "encode_parameters"], [4, 2, 1, "", "evaluate"], [4, 2, 1, "", "fit"], [4, 2, 1, "", "get_num_samples"], [4, 2, 1, "", "get_parameters"], [4, 2, 1, "", "interrupt_fit"], [4, 2, 1, "", "set_data"], [4, 2, 1, "", "set_epochs"], [4, 2, 1, "", "set_model"], [4, 2, 1, "", "set_parameters"]], "p2pfl.learning.pytorch": [[6, 0, 0, "-", "lightninglearner"], [6, 0, 0, "-", "logger"], [7, 0, 0, "-", "mnist_examples"]], "p2pfl.learning.pytorch.lightninglearner": [[6, 1, 1, "", "LightningLearner"]], "p2pfl.learning.pytorch.lightninglearner.LightningLearner": [[6, 2, 1, "", "check_parameters"], [6, 2, 1, "", "decode_parameters"], [6, 2, 1, "", "encode_parameters"], [6, 2, 1, "", "evaluate"], [6, 2, 1, "", "fit"], [6, 2, 1, "", "get_num_samples"], [6, 2, 1, "", "get_parameters"], [6, 2, 1, "", "interrupt_fit"], [6, 2, 1, "", "set_data"], [6, 2, 1, "", "set_epochs"], [6, 2, 1, "", "set_model"], [6, 2, 1, "", "set_parameters"]], "p2pfl.learning.pytorch.logger": [[6, 1, 1, "", "FederatedTensorboardLogger"]], "p2pfl.learning.pytorch.logger.FederatedTensorboardLogger": [[6, 2, 1, "", "finalize"], [6, 2, 1, "", "log_hyperparams"], [6, 2, 1, "", "log_metrics"], [6, 5, 1, "", "name"], [6, 2, 1, "", "save"], [6, 5, 1, "", "version"]], "p2pfl.learning.pytorch.mnist_examples": [[7, 0, 0, "-", "mnistfederated_dm"], [8, 0, 0, "-", "models"]], "p2pfl.learning.pytorch.mnist_examples.mnistfederated_dm": [[7, 1, 1, "", "MnistFederatedDM"]], "p2pfl.learning.pytorch.mnist_examples.mnistfederated_dm.MnistFederatedDM": [[7, 2, 1, "", "test_dataloader"], [7, 2, 1, "", "train_dataloader"], [7, 2, 1, "", "val_dataloader"]], "p2pfl.learning.pytorch.mnist_examples.models": [[8, 0, 0, "-", "cnn"], [8, 0, 0, "-", "mlp"]], "p2pfl.learning.pytorch.mnist_examples.models.cnn": [[8, 1, 1, "", "CNN"]], "p2pfl.learning.pytorch.mnist_examples.models.cnn.CNN": [[8, 2, 1, "", "configure_optimizers"], [8, 2, 1, "", "forward"], [8, 2, 1, "", "test_step"], [8, 3, 1, "", "training"], [8, 2, 1, "", "training_step"], [8, 2, 1, "", "validation_step"]], "p2pfl.learning.pytorch.mnist_examples.models.mlp": [[8, 1, 1, "", "MLP"]], "p2pfl.learning.pytorch.mnist_examples.models.mlp.MLP": [[8, 2, 1, "", "configure_optimizers"], [8, 2, 1, "", "forward"], [8, 2, 1, "", "test_step"], [8, 3, 1, "", "training"], [8, 2, 1, "", "training_step"], [8, 2, 1, "", "validation_step"]], "p2pfl.node": [[3, 1, 1, "", "Node"]], "p2pfl.node.Node": [[3, 2, 1, "", "add_model"], [3, 2, 1, "", "set_data"], [3, 2, 1, "", "set_model"], [3, 2, 1, "", "set_start_learning"], [3, 2, 1, "", "set_stop_learning"], [3, 2, 1, "", "start_learning"], [3, 2, 1, "", "stop"], [3, 2, 1, "", "stop_learning"], [3, 2, 1, "", "update"]], "p2pfl.node_connection": [[3, 1, 1, "", "NodeConnection"]], "p2pfl.node_connection.NodeConnection": [[3, 2, 1, "", "add_param_segment"], [3, 2, 1, "", "clear_buffer"], [3, 2, 1, "", "get_addr"], [3, 2, 1, "", "get_params"], [3, 2, 1, "", "get_ready_status"], [3, 2, 1, "", "is_sending_model"], [3, 2, 1, "", "run"], [3, 2, 1, "", "send"], [3, 2, 1, "", "set_num_samples"], [3, 2, 1, "", "set_ready_status"], [3, 2, 1, "", "set_sending_model"], [3, 2, 1, "", "stop"]], "p2pfl.utils": [[9, 0, 0, "-", "observer"]], "p2pfl.utils.observer": [[9, 1, 1, "", "Events"], [9, 1, 1, "", "Observable"], [9, 1, 1, "", "Observer"]], "p2pfl.utils.observer.Events": [[9, 3, 1, "", "AGREGATION_FINISHED"], [9, 3, 1, "", "END_CONNECTION"], [9, 3, 1, "", "NODE_READY_EVENT"]], "p2pfl.utils.observer.Observable": [[9, 2, 1, "", "add_observer"], [9, 2, 1, "", "get_observers"], [9, 2, 1, "", "notify"]], "p2pfl.utils.observer.Observer": [[9, 2, 1, "", "update"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:exception", "5": "py:property"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "exception", "Python exception"], "5": ["py", "property", "Python property"]}, "titleterms": {"document": 0, "p2p": 1, "feder": 1, "learn": [1, 4, 5, 6, 7, 8], "instal": 2, "p2pfl": [3, 4, 5, 6, 7, 8, 9], "packag": [3, 4, 5, 6, 7, 8, 9], "subpackag": [3, 4, 6, 7], "submodul": [3, 4, 5, 6, 7, 8, 9], "base_nod": 3, "modul": [3, 4, 5, 6, 7, 8, 9], "command": 3, "communication_protocol": 3, "const": 3, "heartbeat": 3, "node": 3, "node_connect": 3, "content": [3, 4, 5, 6, 7, 8, 9], "except": 4, "learner": 4, "agreg": 5, "fedavg": 5, "pytorch": [6, 7, 8], "lightninglearn": 6, "mnist_exampl": [7, 8], "mnistfederated_dm": 7, "model": 8, "cnn": 8, "mlp": 8, "util": 9, "logger": 6, "observ": 9}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})